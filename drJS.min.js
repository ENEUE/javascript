function toTitleCase(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function closeWaitDiv(e){e="#"+e,$(e).hide()}function perkBlocksReset(e){$("#"+e).find(".perkCustomDonationAmount").hide(),$("#"+e).find(".perkPostFlight").hide(),$("#"+e).find(".perkCustomButton").hide(),$("#"+e).find(".perkBody").css("border-bottom","none"),$("#"+e).find(".perkToggle").css("pointer-events","none")}function filterById(e,o){return e.filter(function(e){return Object.keys(o).every(function(n){return e[n]==o[n]})})}function mailChimper(e){var o="https://script.google.com/macros/s/AKfycbwG-vdUup2QUNsU5uH4QjRN9PJyXriwLiXvrwS_YpMQqBY1-8VR/exec",n="email_address="+e.eMail+"&localizer="+e.localizer+"&amount="+e.amount+"&perkID="+e.perkID,a=window.btoa(unescape(encodeURIComponent(n))),n={e:a};$.ajax({type:"post",url:o,jsonpCallback:"returningCharge",dataType:"jsonp",data:n})}function generatePerks(e,o){if(e.length>0){$(o).html("<br>");var n=$("."+o),a=$("<section/>").addClass("outPerks").appendTo(n),t=$("<article/>").addClass("perksContainerBody").attr("id","newPerksOnTheBlock").appendTo(a),r=$("<header/>").appendTo(t),i=[{perkID:"PERK5",perkDescription:"No quieres regalos, ni que tu nombre aparezca en ningún sitio. Te entendemos. Por eso queremos permitirte la posibilidad de que puedas donar a esta campaña y que se respete tu voluntad. Por encima de €3 tú eliges cuánto.",perkConditions:"",perkDelivery:""},{perkID:"PERK3",perkDescription:"Todos los viajes comienzan con un pequeño paso. Te queremos agradecer que hayas iniciado el tuyo con nosotras publicando tu nombre en la web del documental.",perkConditions:"",perkDelivery:"Entrega prevista para "},{perkID:"PERK4",perkDescription:"Si eres de las que te quedas en la sala de cine mirando los créditos cuando ya se ha ido todo el mundo estás de suerte. En la siguiente línea podrías salir tú.",perkConditions:"",perkDelivery:"Entrega prevista para "},{perkID:"PERK20",perkDescription:'<strong>El libro que inspiró nuestro viaje y revolucionó nuestra visión de la educación.</strong> Su autor, Peter Gray, es catedrático de Psicología, y un defensor infatigable y tremendamente lúcido de una educación que responda de verdad a las necesidades de los niños y jóvenes.<br><br>Recibirás como regalo por tu donación "Aprender en libertad" y además tu nombre saldrá en los agradecimientos de la web y en los créditos del documental.<br><br>280 páginas aprox., traducción al español del original en edición de bolsillo con tapas blandas e impreso en papel ecológico.',perkConditions:"Sólo para España. Gastos de envío <em>incluidos</em>.",perkDelivery:"Entrega prevista para "},{perkID:"PERK10",perkDescription:'Cuando conocimos esta historia supimos que <strong>de niños hubiéramos querido que alguien nos la contara.</strong> "Los náufragos de Tonga" es una edición exclusiva de un cuento escrito por Ana García-Castellano e ilustrado por Alicia Borges.<br><br>Recibirás como regalo por tu donación "Los náufragos de Tonga", y además tu nombre saldrá en los agradecimientos de la web y en los créditos del documental.<br><br>Tapas duras, 32 páginas, impreso en papel ecológico a todo color.',perkConditions:"Sólo para España. Gastos de envío <em>incluidos</em>.",perkDelivery:"Entrega prevista para "},{perkID:"PERK22",perkDescription:'Los dos libros que te presentamos son <strong>ediciones que no se encuentran actualmente en el mercado</strong>, y que editaremos exclusivamente para esta campaña. Ambos narran historias reales que dan un giro a la concepción tradicional de la infancia y la educación.<br><br>Recibirás como regalo por tu donación los dos libros que editamos, "Los náufragos de Tonga" y "Aprender en libertad", y tu nombre aparecerá en los agradecimientos de la web así como en los créditos del documental.',perkConditions:"Sólo para España. Gastos de envío <em>incluidos</em>.",perkDelivery:"Entrega prevista para "}],d=$(".eneueSuccessAjax"),s=$("<section/>").appendTo(d);h=$("<div/>").addClass("divPerkResponse").appendTo(s),v=$("<p/>").addClass("perkCenterFont").appendTo(h),$("<strong/>").text("¡Muchas gracias!").appendTo(v),$("<br/>").after("Este proyecto no existiría sin tu ayuda.").appendTo(v),v=$("<p/>").text("En las próximas horas recibirás un email en la dirección que nos indicaste al autorizar el cargo en tu tarjeta. Si transcurridas 72h no lo has recibido comprueba tu bandeja de spam, podría estar ahí. En caso de que no esté escríbenos a:").addClass("perkFontSmall").appendTo(h),$("<br/>").appendTo(v),$("<br/>").appendTo(v),$("<a/>").attr("href","mailto:colabora@estonoesunaescuela.org").attr("target","_top").text("colabora@estonoesunaescuela.org").appendTo(v),$("<br/>").appendTo(v),$("<p/>").text("indicándonos el número de referencia de tu donación y nos pondremos en contacto contigo.").appendTo(v),$("<br/>").appendTo(v),$("<strong/>").text("IMPORTANTE: Si con tu nueva contribución has superado los €25 en total, por favor vuelve a rellenar el formulario, ya que es posible que sea necesario que nos facilites nuevos datos, como la dirección de envío, por ejemplo.").appendTo(v),v=$("<p/>").appendTo(h),$("<span/>").addClass("perkDate").appendTo(v),v=$("<p/>").text("Has realizado una donación adicional de €").appendTo(h),strong=$("<strong/>").appendTo(v),$("<span/>").addClass("perkAmountShow").appendTo(strong),$("<span/>").text(" para la producción de un documental sobre educación con los siguientes datos:").appendTo(v),v=$("<p/>").text("Correo electrónico:").appendTo(h),strong=$("<strong/>").appendTo(v),$("<span/>").addClass("perkEmailShow").appendTo(strong),v=$("<p/>").text("Tarjeta de crédito: **** **** **** ").appendTo(h),strong=$("<strong/>").appendTo(v),$("<span/>").addClass("perkUlt4Show").appendTo(strong),v=$("<p/>").text("Número de referencia (conviene que lo anotes): ").appendTo(h),strong=$("<strong/>").appendTo(v),$("<span/>").addClass("perkLocalizerShow").appendTo(strong);for(var p=e.length-1;p>=0;p--){var l=filterById(i,{perkID:e[p].perkID}),c=e[p].perkID,u=c.replace("PERK",""),m=$("<section/>").addClass("perkContenedor clearfix").attr("id","divPerk"+u).attr("name","PERK"+u).appendTo(r),k=$("<header/>").addClass("headerMain").attr("id","divPerk"+u+"HeaderMain").appendTo(m),w=$("<header/>").addClass("header").attr("id","divPerk"+u+"Header").appendTo(k),h=$("<div/>").addClass("perkTitle").attr("id","divPerk"+u+"Title").appendTo(w),b=$("<h4/>").appendTo(h);$("<input/>").attr("type","radio").attr("name","perkRadio").attr("_parent","divPerk"+u).attr("id","togglePerk"+u).addClass("perkRadio").appendTo(b);var D=$("<label/>").attr("for","togglePerk"+u).text("Dona €").appendTo(b);$("<span/>").attr("id","spanPerk"+u+"Price").text(e[p].perkAmount).appendTo(D),$("<span/>").text(" o más | ").appendTo(D),$("<span/>").attr("id","spanPerk"+u+"Description").text(e[p].perkTitle).appendTo(D),h=$("<div/>").addClass("perkStats").attr("id","divPerk"+u+"Stats").appendTo(w);var v=$("<p/>").appendTo(h);$("<span/>").attr("id","spanPerk"+u+"SoldItems").text(e[p].soldItems).appendTo(v),$("<span/>").text(" apoyos").appendTo(v);var g=$("<section/>").addClass("perkBody").attr("id","divPerk"+u+"Body").appendTo(k);h=$("<div/>").addClass("perkDesc").attr("id","divPerk"+u+"Desc1").appendTo(g),$("<p/>").html(l[0].perkDescription).appendTo(h),h=$("<div/>").addClass("perkDelivery").attr("id","divPerk"+u+"Delivery").appendTo(g);var v=$("<p/>").text(l[0].perkDelivery).appendTo(h);$("<span/>").text(e[p].delivery).attr("id","spanPerk"+u+"Delivery").appendTo(v),$("<br/>").appendTo(v),$("<span/>").html(l[0].perkConditions).appendTo(v);var C=$("<footer/>").addClass("perkSend perkDivHidden").attr("id","divPerk"+u+"Send").appendTo(m);header=$("<header/>").addClass("perkAmount").attr("id","divPerk"+u+"Amount").appendTo(C),$("<label/>").attr("for","divPerk"+u+"customDonationAmount").addClass("amountLabel").text("Cantidad €").appendTo(header),$("<input/>").addClass("perkCustomDonationAmount perkDivHidden").attr("type","number").attr("id","divPerk"+u+"customDonationAmount").attr("step","5").attr("name","perkAmount").attr("pattern","[0-9]*").attr("min",e[p].perkAmount).attr("title","Introduce una cantidad mayor de €"+e.perkAmount).attr("placeholder","p.ej. € "+(e[p].perkAmount+10)).appendTo(header),$("#divPerk"+u+"customDonationAmount").val(e[p].perkAmount),$("<div/>").addClass("perkCustomButton perkButton perkBUttonDisplayNone perkPointer").attr("id","divPerk"+u+"CustomButton").appendTo(C)}}}var redirectDomain="https://script.google.com/macros/s/AKfycbzICEw1n1BrsBsCgPMDL1VQ7bS9ka7O49s1pS4zkTLbM4g_CRNr/exec",responseCodes=["1F4","3F8","5DC","7D0","9C4","BB8","6D6","FA0","DAC"];window.perkTokenBeenCalled=!1,window.perkButtonEnd=!1,window.perkToggleState=null,$(window).on("popstate",function(){handler.close()}),$(document).on("DOMNodeRemoved",".stripe_checkout_app",close);var handler=StripeCheckout.configure({key:"pk_live_uWo17rHYl0BXyyKmoMtHM3aS",image:"https://estonoesunaescuela.squarespace.com/s/anagrama_peq_color_whitebckgrnd_small.png",locale:"auto",currency:"EUR",panelLabel:"Dona {{amount}}",allowRememberMe:!1,token:function(e,o){window.perkTokenBeenCalled=!0;var n="stripeEmail="+e.email+"&stripeToken="+e.id+"&amount="+window.amountCents+"&itemID="+window.perkCode+"&localizer="+window.eneueTransactionLocalizer+"&islive="+e.livemode,a=window.btoa(unescape(encodeURIComponent(n))),n={e:a},t=$.ajax({type:"get",url:redirectDomain,jsonpCallback:"callback",contentType:"application/json",dataType:"jsonp",data:n});$(".eneueBodyText").hide(),$(".eneueContributionData").hide(),$(".eneueUpdatedData").hide(),$(".eneuePerks").hide(),$(".perkWait").show(),t.done(function(e){$(".perkWait").hide();var o=new Date,n=o.toLocaleDateString(),a=o.toLocaleTimeString(),t="El día "+n+" a las "+a,r=!1,i=!1;if(e.responsecode==responseCodes[8]&&(i=!0),r)$(".eneueSuccessAjax").html("Se ha producido un error en el servidor. Inténtelo más tarde.");else if(i)$(".eneueSuccessAjax").html("El servidor está ocupado en este momento. Vuelve a intentarlo en un minuto.");else{window.amountR=e.amount/100,window.last4=e.last4,window.eMail=e.eMail,window.localizer=e.localizer,$(".eneueSuccessAjax").find(".perkAmountShow").html(window.amountR),$(".eneueSuccessAjax").find(".perkUlt4Show").html(window.last4),$(".eneueSuccessAjax").find(".perkEmailShow").html(window.eMail),$(".eneueSuccessAjax").find(".perkLocalizerShow").html(window.localizer),$(".eneueSuccessAjax").find(".perkDate").html(t);window.perkTokenBeenCalled=!1,window.perkButtonEnd=!0,window.beenShared=!1,$(".eneueSuccessAjax").show(),$("#block-yui_3_17_2_2_1455033745983_13062").show(),mailChimper(e)}})}});$(document).on("click",".perkRadio",function(e){$(".perkSend").hide(),$(".perkPostFlight").hide(),$(".perkCustomButton").hide(),$(".perkBody").css("border-bottom","none"),window.containerID=e.currentTarget.attributes._parent.value,$("#"+window.containerID).siblings().css("border","none"),$("#"+window.containerID).siblings().css("box-shadow","none"),$("#"+window.containerID).css("border","2px solid #AB0096"),$("#"+window.containerID).css("box-shadow","2px 2px 8px 1px #766896"),$("#"+window.containerID).find(".perkCustomDonationAmount").on("input",function(){$(this).val()}),window.amount=$("#"+window.containerID).find(".perkCustomDonationAmount").val(),$(".perkContenedor").css("height","auto"),$("#"+window.containerID).find(".perkCustomButton").html("Continuar"),$("#"+window.containerID).find(".perkBody").css("border-bottom","dashed 1px lightgrey"),$("#"+window.containerID).find(".perkCustomDonationAmount").css("display","block"),$("#"+window.containerID).find(".perkCustomButton").show(),$("#"+window.containerID).find(".perkCustomDonationAmount").show(),$("#"+window.containerID).find(".perkSend").show(),$("#"+window.containerID).find(".perkPreFlight").show()}),$(document).on("click",".perkCustomButton",function(e){var o=window.containerID;o=o.replace("div","");var n=$("#"+window.containerID).find(".perkCustomDonationAmount").attr("id"),a=parseInt($("#"+window.containerID).find(".perkCustomDonationAmount").attr("min"),10);parseInt($("#"+n).val(),10)<a&&$("#"+n).val(a),0==window.perkButtonEnd?(window.amount=$("#"+window.containerID).find(".perkCustomDonationAmount").val(),window.amountCents=100*window.amount,window.perkCode=$("#"+window.containerID).attr("name"),window.perkDescription=$("#"+window.containerID).find("span#span"+o+"Description").text(),handler.open({name:"@noesunaescuela",description:window.perkDescription,amount:window.amountCents})):1==window.perkButtonEnd&&(perkBlocksReset(window.containerID),window.perkButtonEnd=!1)}),$(document).ready(function(){var e=["nombre","apellidos","DNI","creditos","dir1","dir2","ciudad","cp"];$("#block-yui_3_17_2_21_1454415124886_5895").hide(),$("#block-yui_3_17_2_2_1455033745983_13062").hide(),$("#block-yui_3_17_2_2_1456637596700_7472").hide(),$(".updateFormContainer").hide(),$(".updateFormNoData").hide(),$(".eneueContributionData").hide(),$(".eneuePerks").hide(),$(".eneueUpdatedData").hide(),$("#block-yui_3_17_2_22_1454415124886_463220").find("form").find("input.text").attr("name","localizer"),$("#block-yui_3_17_2_22_1454415124886_463220").find("form").submit(function(e,o){$theForm=$(this),window.updateCustomerData=$theForm.serialize()}),$("#block-yui_3_17_2_21_1454415124886_5895").find("form").find("input.text").each(function(o){$(this).attr("name",e[o])}),$("#block-yui_3_17_2_21_1454415124886_5895").find("form").submit(function(e,o){$theForm=$(this),window.updateCustomerDataQuery=$theForm.serialize()})}),$("#block-yui_3_17_2_2_1455033745983_13062").find("a").click(function(e){e.preventDefault(),location.reload(!0)}),$("#block-yui_3_17_2_2_1456637596700_7472").find("a").click(function(e){e.preventDefault(),$("#block-yui_3_17_2_21_1454415124886_5895").show(),$(".eneueContributionData").show(),$(".eneueUpdatedData").show(),$("#block-yui_3_17_2_2_1456637596700_7472").hide()});